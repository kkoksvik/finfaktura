## Hvordan utvikle finfaktura
## $Id$
## Håvard Gulldahl <havard@gulldahl.no> (C) 2005-2008


### Lage ny release ###

* Dytte på versjonsnummeret i finfaktura/__init__.py => $VERSJON
    export VERSJON=$(./faktura.py -v); echo $VERSJON;

* Oppgradere debian changelog
    dch --newversion $VERSJON
    -> skrive inn hva som har skjedd siden $VERSJON-1

* Laste ned svn-logg
    svn2cl.sh # finnes på http://ch.tudelft.nl/~arthur/svn2cl/downloads.html

* Commite endringer til svn
    svn commit ChangeLog finfaktura/__init__.py debian/changelog -m "Gjør $VERSJON klar til utgivelse"

* Kopiere til ny grein:
    svn copy https://finfaktura.googlecode.com/svn/trunk https://finfaktura.googlecode.com/svn/branches/$VERSJON -m "Kopierer $VERSJON til egen gren"

* Sjekke ut den nye greina, og begynne å jobbe på den
    cd /tmp
    svn co https://finfaktura.googlecode.com/svn/branches/$VERSJON
    cd $VERSJON

* Endre på PRODUKSJONSVERDI-variabelen (til True) i finfaktura/fakturabibliotek.py
    perl -pi -e 's/PRODUKSJONSVERSJON=False/PRODUKSJONSVERSJON=True/' finfaktura/fakturabibliotek.py

* Prøvestarte programmet og se at alt ser greit ut
    FAKTURADIR=. ./faktura.py
    FAKTURADIR=. FAKTURADB=testdata.db ./faktura.py

* Lage .deb
    #fakeroot debian/rules binary
    debuild -khavard@lurtgjort.no

* Installer programmet og prøv å starte det
   sudo dpkg -i /tmp/finfaktura_${VERSJON}_*.deb

* Committe endringer til svn dersom .deb gikk smertefritt
    svn commit -m "pakker og klargjør $VERSJON til produksjon"

* Tagge versjonen dersom .deb gikk smertefritt
    svn copy https://finfaktura.googlecode.com/svn/branches/$VERSJON https://finfaktura.googlecode.com/svn/tags/versjon-$VERSJON -m "Tagger ferdigstilt $VERSJON"

* Lage skjermdump
    doc/skjermdump.sh
    <tilpasse navn og innhold etter skjermdump.sh>
    svn co https://finfaktura.googlecode.com/svn/screenshots
    for b in skjermbilder-finfaktura-${VERSJON}*/*.png; do convert -resize 75% $z screenshots/$z;done
    svn commit screenshots -m "Skjermbilder for ${VERSJON}"


* Kopier til http://code.google.com/p/finfaktura/downloads/entry
    #http://support.googlecode.com/svn/trunk/scripts/googlecode-upload.py

    -> .deb
    googlecode-upload.py -s "Fryktelig fin faktura (debian/ubuntu), versjon $VERSJON" -p finfaktura -u havard.gulldahl -l "Featured,Type-Package,OpSys-Linux" ../finfaktura_${VERSJON}_all.deb

    -> .rpm
    fakeroot alien --to-rpm --scripts --keep-version finfaktura_${VERSJON}_*.deb

    googlecode-upload.py -s "Fryktelig fin faktura (fedora/suse), versjon $VERSJON" -p finfaktura -u havard.gulldahl -l "Featured,Type-Package,OpSys-Linux" ../finfaktura-${VERSJON}*noarch.rpm

    -> source
    python setup.py sdist --format=zip
    googlecode-upload.py -s "Fryktelig fin faktura (python kildekode), versjon $VERSJON" -p finfaktura -u havard.gulldahl -l "Featured,Type-Package,OpSys-All" dist/finfaktura-${VERSJON}.zip


* Hurra!

